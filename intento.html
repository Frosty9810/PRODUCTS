<!DOCTYPE html>
<html>
  <head>
    <title>PRODUCTS</title>
  </head>
  <body>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <h1>PRODUCTS</h1>
    <div id="app">
      <table border="1px" id="table" width=100% style="background-color:#A2B9C7">
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Code</th>
          <th>Stock</th>
          <!--<th>EDIT</th>-->
          <th>ACTION</th>
        </tr>
       
		<tr>
            <td id="name" contenteditable="true"style="background-color:#D9EC9C"></td>
            <td id="type" contenteditable="false"style="background-color:#D9EC9C">
			<div class="IsSoccer" onclick="toggle(this)" style="background-color:#D9EC9C"><a href="#">SOCCER</a></div></td>
            <td id="code" contenteditable="false"style="background-color:#D9EC9C">SOCCER</td>
            <td id="stock" contenteditable="true"style="background-color:#D9EC9C">0</td>
            <td><button v-on:click="addtt" style="background:cyan;width:100%;height:100%">ADD</button></td>
        </tr>
        <tr v-for="product in products">
            <td contenteditable="false" style="background-color:#D4D4D4">{{ product.name }}</td>
            <td contenteditable="false" style="background-color:#D4D4D4">{{ product.type }}</td>
            <td contenteditable="false"style="background-color:#D4D4D4">{{ product.code }}</td>
            <td contenteditable="false"style="background-color:#D4D4D4">{{ product.stock }}</td>
            <!--<td><button v-on:click="updat(product.name,product.type,product.code,product.stock)">EDIT</button></td>-->
            <td><button v-on:click="delet(product.code)" style="background:#FA6E8A;width:100%;height:100%" >DELETE</button></td>
        </tr>
      </table>
    </div>
	
	<script type = "text/javascript">
	function toggle(t) {
	if(t.childNodes[0].innerHTML=="SOCCER"){
	t.childNodes[0].innerHTML = "BASKET"
	var switchCode = document.getElementById("code")
	switchCode.innerHTML = "BASKET"
	}else{
	t.childNodes[0].innerHTML = "SOCCER"
	var switchCode = document.getElementById("code")
	switchCode.innerHTML = "SOCCER"}}
	</script>
	
    <script>
      function getAll(){
        var xmlHttp = new XMLHttpRequest();
        xmlHttp.open('GET', 'http://localhost:4401/product');
        xmlHttp.setRequestHeader('Content-Type', 'text/plain');
        xmlHttp.responseType = 'json';
        xmlHttp.send();
        xmlHttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            app.products = xmlHttp.response;
          }
        };
      }

      getAll();

      var app = new Vue({
        el: '#app',
        data: {
          products: null
        },
        methods: {
            delet: function(code){
              var xmlHttpD = new XMLHttpRequest();
              xmlHttpD.open('DELETE', 'http://localhost:4401/product/' + code);
              xmlHttpD.setRequestHeader('Content-Type', 'text/plain');
              xmlHttpD.send();
              xmlHttpD.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                  getAll();
                }
              };
            },/*
            updat: function(name, type, code, stock){
              var newp = JSON.stringify({
                name: name,
                type: type,
                code: code,
                stock: stock
              });
              var xmlHttpU = new XMLHttpRequest();
              xmlHttpU.open('PUT', 'http://localhost:4401/product/' + code);
              xmlHttpU.setRequestHeader('Content-Type', 'application/json');
              xmlHttpU.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    alert(xmlHttpU.responseText);
                }
              };
              xmlHttpU.send(newp);
              getAll();
            },*/
            addtt: function(){
              var newp = JSON.stringify({
			  
			  
                name: document.getElementById("name").innerHTML,
                type: document.getElementById("code").innerHTML,
                code: document.getElementById("code").innerHTML,
                stock: Number(document.getElementById("stock").innerHTML)
              });
			  
			  
			  
              var xmlHttpA = new XMLHttpRequest();
              xmlHttpA.open('POST', 'http://localhost:4401/product', true);
              xmlHttpA.setRequestHeader('Content-Type', 'application/json');
              xmlHttpA.send(newp);
              xmlHttpA.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    getAll();
                    alert("Added");
                }
              };
              
			  document.getElementById("name").innerHTML = ""
              document.getElementById("stock").innerHTML = "0"
              
              
            }
        }
      });
        </script>
    </body>
</html>